#!/usr/bin/env php
<?php

/*
 * This file is part of the Blackfire Player package.
 *
 * (c) Fabien Potencier <fabien@blackfire.io>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */

set_time_limit(0);

/** @var string[] $autoloadLocations */
$autoloadLocations = array(
    getcwd() . '/vendor/autoload.php',
    getcwd() . '/../../autoload.php',
    __DIR__ . '/../vendor/autoload.php',
    __DIR__ . '/../../../autoload.php'
);
/** @var bool $loaded */
$loaded = false;

/** @var string $autoload */
foreach ($autoloadLocations as $autoload) {
    if (is_file($autoload)) {
        require_once $autoload;
        $loaded = true;

        break;
    }
}

if (!$loaded) {
    fwrite(
        STDERR,
        'You must set up the project dependencies, run the following commands:' . PHP_EOL . 'curl -s http://getcomposer.org/installer | php' . PHP_EOL . 'php composer.phar install' . PHP_EOL
    );
    die(1);
}

unset($loaded, $autoloadLocations, $autoload);

use Blackfire\Player\Console\Application;
use Blackfire\Player\Console\OutputErrorHandler;

/** @var Application $application */
$application = new Application();
(new OutputErrorHandler())->install($application);

$application->run();
